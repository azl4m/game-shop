<%- include("../partials/user/header.ejs")%>
<style>
    /* Modern CSS Reset */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Inter', 'Segoe UI', Tahoma, sans-serif;
}

.body {
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.big-container {
    width: 100%;
    max-width: 380px;
    margin: 15px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    overflow: hidden;
}

.signup-container {
    padding: 20px 50px 15px;
}

.signup-container h2 {
    text-align: center;
    color: #2d3748;
    margin-bottom: 25px;
    font-size: 24px;
    font-weight: 700;
}

form {
    display: flex;
    flex-direction: column;
    gap: 16px;
    width: 100%;
}

label {
    color: #4a5568;
    font-size: 14px;
    font-weight: 500;
    display: block;
    margin-bottom: 6px;
    text-align: left;
}

input {
    width: 100%;
    padding: 10px 12px;
    border: 1.5px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.2s ease;
}

input:focus {
    outline: none;
    border-color: #4299e1;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
}

.error-message {
    color: #e53e3e;
    font-size: 12px;
    margin-top: 4px;
    text-align: left;
}

button[type="submit"] {
    background: linear-gradient(to right, #4299e1, #667eea);
    color: white;
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s ease;
    margin-top: 10px;
}

button[type="submit"]:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(66, 153, 225, 0.2);
}

/* Improved Google Login Button */
.googlelogin-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    background: white;
    color: #4a5568;
    width: 100%;
    padding: 12px;
    border: 1.5px solid #e2e8f0;
    border-radius: 8px;
    text-decoration: none;
    font-size: 15px;
    font-weight: 500;
    margin-top: 16px;
    transition: all 0.2s ease;
}

.googlelogin-button::before {
    content: '';
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23FFC107' d='M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 12.955 4 4 12.955 4 24s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z'/%3E%3Cpath fill='%23FF3D00' d='m6.306 14.691 6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 16.318 4 9.656 8.337 6.306 14.691z'/%3E%3Cpath fill='%234CAF50' d='M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238A11.91 11.91 0 0 1 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z'/%3E%3Cpath fill='%231976D2' d='M43.611 20.083H42V20H24v8h11.303a12.04 12.04 0 0 1-4.087 5.571l.003-.002 6.19 5.238C36.971 39.205 44 34 44 24c0-1.341-.138-2.65-.389-3.917z'/%3E%3C/svg%3E");
    width: 18px;
    height: 18px;
    display: inline-block;
    background-size: contain;
    background-repeat: no-repeat;
    vertical-align: middle;
}

.googlelogin-button:hover {
    background: #f8fafc;
    border-color: #cbd5e0;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

/* Separator between buttons */
.or-separator {
    display: flex;
    align-items: center;
    text-align: center;
    margin: 20px 0;
    width: 100%;
}

.or-separator::before,
.or-separator::after {
    content: '';
    flex: 1;
    border-bottom: 1.5px solid #e2e8f0;
}

.or-separator span {
    padding: 0 10px;
    color: #a0aec0;
    font-size: 14px;
}

/* Responsive Design */
@media (max-width: 480px) {
    .big-container {
        margin: 10px;
        max-width: 100%;
    }

    .signup-container {
        padding: 15px 12px;
    }

    .signup-container h2 {
        font-size: 22px;
        margin-bottom: 20px;
    }
}

/* Input Validation Styles */
input:invalid {
    border-color: #fc8181;
}

input:valid:not(:placeholder-shown) {
    border-color: #68d391;
}

/* Animation for form submission */
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

.error-shake {
    animation: shake 0.4s ease-in-out;
}
</style>

<body>
    <div class="body">
        <div class="big-container">
            <div class="signup-container">
            <h2>Signup</h2>
            <form action="/signup" method="post" id="signForm">
                <label for="user">Username</label>
                <input type="text" id="name" name="username" required>
                
                <span id="error1" class="error-message"></span>
    
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
    
                <span id="error2" class="error-message"></span>
    
    
                <label for="phone">Phone</label>
                <input type="tel" id="phone" name="phone" required>
    
                <label for="referralCode">Referral Code</label>
                <input type="text" name="referralCode" id="referralCode">
    
                <span id="error3" class="error-message"></span>
    
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
                
                <span id="error4" class="error-message"></span>
    
                <label for="cpassword">Confirm Password</label>
                <input type="password" id="cpassword" name="cPassword" required>
    
                <span id="error5" class="error-message">
                    <%  
                    if(typeof message !== 'undefined'){
                        %>
                        <%= message %>
                        <%
                    }
                    %>
                </span>
    
                <button type="submit">Sign Up</button>
                <div class="or-separator">
                    <span>OR</span>
                </div>
                <a href="/auth/google" class="googlelogin-button" >Google Signup</a>
            </form>
        </div>
    
        </div>     
    </div>
   

  
<%- include("../partials/user/footer.ejs")%>
 
<script>
    const nameid = document.getElementById("name")
    const emailid = document.getElementById("email")
    const phoneid = document.getElementById("phone")
    const passid = document.getElementById("password")
    const cpassid = document.getElementById("cpassword")
    const error1 = document.getElementById("error1")
    const error2 = document.getElementById("error2")
    const error3 = document.getElementById("error3")
    const error4 = document.getElementById("error4")
    const error5 = document.getElementById("error5")
    const signForm = document.getElementById("signForm")

    function nameValidate(e){
        const nameVal = nameid.value;
        const namePattern = /^[A-Za-z\s]+$/;
        if(nameVal.trim()===""){
            error1.style.display = "block";
            error1.innerHTML="Please enter a valid name"
        }else if(!namePattern.test(nameVal)){
            error1.style.display = "block";
            error1.innerHTML = "Name can only contain alphabets"
        }else{
            error1.style.display ="none";
            error1.innerHTML=""
        }
    }

    function emailValidate(e){
        const emailVal = emailid.value;
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

        if(!emailPattern.test(emailVal)){
            error2.style.display = "block";
            error2.innerHTML = "Please enter a valid email";
        }else{
            error2.style.display = "none";
            error2.innerHTML ="";
        }

    }

    function phoneValidate(e){
        
        const phoneVal = phoneid.value;
        const phonePattern = /^\d{10}$/;

        if(phoneVal.trim()===""){
            error3.style.display = "block";
            error3.innerHTML = "Enter valid phone number"  
        }else if(!phonePattern.test(phoneVal)){
            error3.style.display = "block";
            error3.innerHTML = "Enter 10 digits phone number"
        }
        else if(phoneVal.length!==10){
            error3.style.display = "block";
            error3.innerHTML = "Enter 10 digits phone number"
        }else{
            error3.style.display = "none";
            error3.innerText = "";
        }
    }

    function passValidate(e){
        const passVal = passid.value;
        const cpassVal = cpassid.value;
        const passPattern = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        if(!passPattern.test(passVal)){
            error4.style.display = "block";
            error4.innerHTML = "Password should contain alphabets,numbers and special characters and should be atleast 8 characters long"
        }else{
            error4.style.display = "none";
            error4.innerHTML = "";
        }
        if(passVal !== cpassVal){
            error5.style.display = "block";
            error5.innerHTML = "Passwords do not match"
        }else{
            error5.style.display = "none";
            error5.innerHTML = "";
        }

    }

    document.addEventListener("DOMContentLoaded",()=>{
        signForm.addEventListener("submit",(e)=>{
            nameValidate();
            emailValidate();
            phoneValidate();
            passValidate();
            if(
                !nameid||!emailid||!phoneid||!passid||!error1||!error2||!error3||!error4||!error5||!signForm
            ){
                console.log("One or more elements not found")
            }
            if(
                error1.innerHTML||error2.innerHTML||error3.innerHTML||error4.innerHTML||error5.innerHTML
            ){
                e.preventDefault();
            }
        })
    })
</script>